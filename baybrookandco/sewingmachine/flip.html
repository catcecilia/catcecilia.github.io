<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sewing Machine Invoice of Sale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for print media and general aesthetics */
        @media print {
            body {
                margin: 0;
                padding: 0;
                color: #000;
                background-color: #fff;
            }
            .document-card {
                box-shadow: none !important;
                border: none !important;
                width: 100%;
                max-width: none;
                margin: 0;
                padding: 0;
            }
            /* Ensure inputs and textareas are visible for printing */
            input[type="text"], textarea {
                border-bottom: 1px solid #333 !important;
                border-top: none !important;
                border-left: none !important;
                border-right: none !important;
                padding: 0 4px !important;
            }
            /* Remove background from the clause section when printing */
            .clause-section {
                background-color: transparent !important;
                border: 1px solid #333 !important;
            }
            .no-print {
                display: none;
            }
            /* Ensure canvas background is white for printing */
            .signature-pad {
                background-color: #ffffff !important;
            }
        }

        /* Set default font to Inter */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
            color: #1f2937;
        }
        
        /* Style for the canvas */
        .signature-pad {
            cursor: crosshair;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-red': '#dc2626',
                        'secondary-gray': '#4b5563',
                        'primary-blue': '#2563eb',
                    }
                }
            }
        }
    </script>
</head>
<body class="p-4 md:p-8">
    <div class="document-card bg-white shadow-2xl rounded-2xl p-6 md:p-10 mx-auto max-w-5xl border border-gray-100">

        <form>
            <button type="button" onclick="window.print()" class="no-print bg-primary-red text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-red-700 transition duration-150 absolute top-4 right-4 text-sm">
                Print Invoice
            </button>

            <header class="flex flex-col sm:flex-row justify-between items-start mb-8 border-b-4 border-primary-red pb-4">
                <div class="space-y-1">
                    <h1 class="text-4xl font-extrabold text-primary-red tracking-tight">INVOICE OF SALE</h1>
                    <p class="text-lg text-secondary-gray font-semibold">Refurbished Sewing Machine Purchase</p>
                </div>
                <div class="mt-4 sm:mt-0 text-right space-y-1 text-sm text-gray-600">
                    <p class="text-xl font-bold text-primary-red">Baybrook & Co</p>
                    <p>Date of Sale: <input type="text" name="DateOfSale" id="DateOfSale" class="border-b border-gray-300 w-28 p-1 focus:border-primary-red focus:outline-none" placeholder="YYYY-MM-DD"></p>
                    <p>Invoice #: <input type="text" name="InvoiceNum" id="InvoiceNum" value="INV-2025-" class="border-b border-gray-300 w-32 p-1 focus:border-primary-red focus:outline-none"></p>
                </div>
            </header>

            <section class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                    <h2 class="text-base font-bold text-secondary-gray mb-3 border-b pb-1">CUSTOMER INFORMATION</h2>
                    <div class="space-y-2 text-sm">
                        <p>Name: <input type="text" name="CustName" id="CustName" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="Jane Doe"></p>
                        <p>Phone: <input type="text" name="CustPhone" id="CustPhone" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="(555) 123-4567"></p>
                        <p>Email: <input type="text" name="CustEmail" id="CustEmail" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="jane.doe@example.com"></p>
                    </div>
                </div>
                
                <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                    <h2 class="text-base font-bold text-secondary-gray mb-3 border-b pb-1">PURCHASED MACHINE DETAILS</h2>
                    <div class="space-y-2 text-sm">
                        <p>Make: <input type="text" name="MachineMake" id="MachineMake" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="Singer / Kenmore"></p>
                        <p>Model: <input type="text" name="MachineModel" id="MachineModel" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="401A"></p>
                        <p>Serial #: <input type="text" name="SerialNum" id="SerialNum" class="border-b border-gray-300 w-full p-1 focus:border-primary-red focus:outline-none" placeholder="NA123456"></p>
                        <p>Price: $ <input type="text" name="SalePrice" id="SalePrice" class="border-b border-gray-300 w-24 p-1 focus:border-primary-red focus:outline-none" placeholder="450.00"></p>
                    </div>
                </div>
            </section>

            <section class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h2 class="text-base font-bold text-secondary-gray mb-2 border-b pb-1">INCLUDED ACCESSORIES</h2>
                    <textarea rows="6" name="IncludedAccessories" id="IncludedAccessories" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:border-primary-red focus:ring-1 focus:ring-primary-red" placeholder="e.g., Foot Pedal, Power Cord, 3 Bobbins, Zipper Foot, Original Manual..."></textarea>
                </div>
                <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                    <h2 class="text-base font-bold text-secondary-gray mb-3 border-b pb-1">FINANCIAL SUMMARY</h2>
                    <div class="space-y-4 text-sm">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Machine Price:</span>
                            <span class="font-medium">$<span id="priceDisplay">0.00</span></span>
                        </div>
                        <div class="flex justify-between items-center">
                            <label for="TaxRate" class="text-gray-600">Sales Tax Rate (%):</label>
                            <input type="text" name="TaxRate" id="TaxRate" class="border-b border-gray-300 w-20 p-1 text-right focus:border-primary-red focus:outline-none" placeholder="8.25">
                        </div>
                        <div class="flex justify-between items-center">
                            <label for="TaxAmount" class="text-gray-600">Sales Tax Amount:</label>
                            $<input type="text" name="TaxAmount" id="TaxAmount" class="border-b border-gray-300 w-20 p-1 text-right focus:border-primary-red focus:outline-none" placeholder="0.00">
                        </div>
                        <hr>
                        <div class="flex justify-between items-center text-lg font-bold text-primary-red">
                            <label for="TotalDue">TOTAL DUE:</label>
                            $<input type="text" name="TotalDue" id="TotalDue" class="border-b-2 border-primary-red w-32 p-1 text-right focus:outline-none font-bold" placeholder="0.00">
                        </div>
                    </div>
                </div>
            </section>

            <section class="mb-10 clause-section p-6 bg-red-100 rounded-lg border-2 border-primary-red shadow-lg">
                <h2 class="text-xl font-bold text-primary-red mb-4 border-b-2 border-primary-red pb-1">TERMS OF SALE (AS-IS)</h2>
                
                <div class="text-sm text-gray-700 space-y-3">
                    <p class="font-semibold">By signing below, the Customer acknowledges and agrees to the following terms of sale:</p>

                    <ul class="list-disc list-inside space-y-3 ml-4">
                        <li><strong>"AS-IS" Condition:</strong> The Customer acknowledges purchasing this machine in its current "AS-IS" condition. The machine has passed a functional sewing/stitch test at the time of refurbishment. However, the Customer understands and accepts that this is a vintage, refurbished item and all risks are transferred to the Customer at the time of sale.</li>

                        <li><strong>Acceptance of Risk:</strong> The Customer accepts all risks associated with the machine's condition, including but not limited to:
                            <ul class="list-disc list-inside ml-6 space-y-1 mt-2">
                                <li>Cosmetic blemishes, scratches, or rust.</li>
                                <li>Latent, non-obvious, or intermittent faults, such as potential electrical issues, old wiring, or internal mechanical problems that were not apparent during testing.</li>
                                <li>Future failures of any component.</li>
                            </ul>
                        </li>

                        <li class="font-bold text-primary-red"><strong>FINAL SALE - NO WARRANTY:</strong> This sale is final at the moment of purchase. No warranty, express or implied, is provided. No refunds, returns, or exchanges will be accepted for any reason.</li>
                    </ul>

                    <p class="pt-2 font-medium">The Customer's signature confirms they have read, understood, and accepted these terms and that the sale is final.</p>
                </div>
            </section>

            <section class="pt-4 border-t border-gray-300">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-sm">
                    
                    <div>
                        <canvas id="custSignaturePad" class="signature-pad border border-gray-500 rounded-md w-full h-32 bg-white"></canvas>
                        <button type="button" onclick="clearSignature('custSignaturePad')" class="no-print text-sm text-blue-600 hover:text-blue-800 mt-1">Clear Customer Signature</button>
                        <p class="text-center text-secondary-gray mt-2">Customer Signature / Acceptance</p>
                    </div>
                    
                    <div>
                        <canvas id="sellerSignaturePad" class="signature-pad border border-gray-500 rounded-md w-full h-32 bg-white"></canvas>
                        <button type="button" onclick="clearSignature('sellerSignaturePad')" class="no-print text-sm text-blue-600 hover:text-blue-800 mt-1">Clear Seller Signature</button>
                        <p class="text-center text-secondary-gray mt-2">Seller Signature</p>
                    </div>

                </div>
            </section>
            <p class="text-center text-sm text-gray-500 mt-8">https://baybrookandco.carrd.co/</p>
        </form>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const salePriceInput = document.getElementById('SalePrice');
            const taxRateInput = document.getElementById('TaxRate');
            const taxAmountInput = document.getElementById('TaxAmount');
            const totalDueInput = document.getElementById('TotalDue');
            const priceDisplaySpan = document.getElementById('priceDisplay');

            function calculateInvoice() {
                const price = parseFloat(salePriceInput.value) || 0;
                const rate = parseFloat(taxRateInput.value) || 0;

                const taxAmount = (price * rate) / 100;
                const totalDue = price + taxAmount;

                // Update the display fields
                priceDisplaySpan.textContent = price.toFixed(2);
                taxAmountInput.value = taxAmount.toFixed(2);
                totalDueInput.value = totalDue.toFixed(2);
            }

            // Add event listeners to calculate on input
            salePriceInput.addEventListener('input', calculateInvoice);
            taxRateInput.addEventListener('input', calculateInvoice);
            
            // Optional: Also allow changing tax/total manually
            taxAmountInput.addEventListener('input', () => {
                 const price = parseFloat(salePriceInput.value) || 0;
                 const tax = parseFloat(taxAmountInput.value) || 0;
                 totalDueInput.value = (price + tax).toFixed(2);
                 priceDisplaySpan.textContent = price.toFixed(2);
            });
            totalDueInput.addEventListener('input', () => {
                 priceDisplaySpan.textContent = (parseFloat(salePriceInput.value) || 0).toFixed(2);
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Helper function to initialize a single signature pad ---
            function initializeSignaturePad(canvasId) {
                const canvas = document.getElementById(canvasId);
                if (!canvas) return; // Exit if canvas not found
                
                const ctx = canvas.getContext('2d');
                let drawing = false;

                // Set canvas size for high-DPI displays
                // Use offsetWidth/Height as it reflects the rendered size
                function resizeCanvas() {
                    const dpr = window.devicePixelRatio || 1;
                    canvas.width = canvas.offsetWidth * dpr;
                    canvas.height = canvas.offsetHeight * dpr;
                    ctx.scale(dpr, dpr);
                    
                    // Set styles again after resize
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 2;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                }
                
                // Initial resize
                resizeCanvas();
                
                // Re-resize if window changes
                window.addEventListener('resize', resizeCanvas);

                // Get position relative to canvas
                function getPosition(event) {
                    const rect = canvas.getBoundingClientRect();
                    let posX, posY;

                    // Handle touch events
                    if (event.touches && event.touches.length > 0) {
                        posX = event.touches[0].clientX - rect.left;
                        posY = event.touches[0].clientY - rect.top;
                    }
                    // Handle mouse events
                    else {
                        posX = event.clientX - rect.left;
                        posY = event.clientY - rect.top;
                    }
                    return { x: posX, y: posY };
                }

                function startDrawing(event) {
                    drawing = true;
                    const pos = getPosition(event);
                    ctx.beginPath();
                    ctx.moveTo(pos.x, pos.y);
                }

                function draw(event) {
                    if (!drawing) return;
                    event.preventDefault(); // Prevent scrolling while drawing
                    const pos = getPosition(event);
                    ctx.lineTo(pos.x, pos.y);
                    ctx.stroke();
                }

                function stopDrawing() {
                    drawing = false;
                    ctx.beginPath(); // Reset the path
                }

                // --- Event Listeners ---
                // Mouse events
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseleave', stopDrawing);

                // Touch events
                canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault(); // Prevent "mouse" events
                    startDrawing(e);
                }, { passive: false });
                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault(); // Prevent scrolling
                    draw(e);
                }, { passive: false });
                canvas.addEventListener('touchend', stopDrawing);
                canvas.addEventListener('touchcancel', stopDrawing);
            }

            // Initialize both pads
            initializeSignaturePad('custSignaturePad');
            initializeSignaturePad('sellerSignaturePad');

            // --- Global Clear Function ---
            // Make clear function available globally for the onclick attribute
            window.clearSignature = (canvasId) => {
                const canvas = document.getElementById(canvasId);
                const ctx = canvas.getContext('2d');
                // Use canvas.width/height (the *buffer* size) not the CSS size
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            };
        });
    </script>
</body>
</html>
